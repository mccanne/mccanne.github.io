function log(a){if(1){console.log(a)}}var m={top:15,right:10,bottom:4,left:30},strip_w=900,strip_h=50,strip_eh=75,highlight_w=2,w=strip_w+m.right+m.left+highlight_w*2,h=strip_h+m.top+m.bottom+highlight_w*2,yscale=d3.scale.linear().domain([0,14]).range([dbd.height,0]),bgscale=d3.scale.linear().domain([40,350]).range([dbd.height,0]);function yhscale(a){if(a>350){a=350}if(a<40){a=40}return bgscale(a)}tooltip={};tooltip.div=d3.select("body").append("div").style("position","absolute").style("z-index","10").style("visibility","hidden").style("color","white").text("a simple tooltip");tooltip.locked=false;tooltip.travel=function(){var b=(d3.event.pageY-10)+"px";var a=(d3.event.pageX+10)+"px";this.div.style("top",b).style("left",a)};tooltip.enable=function(a,b){if(!this.locked){this.div.text(b);this.div.style("visibility","visible");this.item=a;this.div.attr("stroke","white");this.travel()}};tooltip.disable=function(){if(!this.locked){this.div.style("visibility","hidden");this.div.attr("stroke","none");this.item=undefined}};tooltip.lock=function(){this.locked=true};tooltip.unlock=function(){this.locked=false};tooltip.break_lock=function(){if(this.locked){this.locked=false;this.disable()}};var shake_item=undefined;var shake_dx=1;function stop_shaking(){shaking=false}function shake_me_more(){shake_dx=-shake_dx;var a=shake_item;if(shaking){dx=shake_dx}else{dx=0}d3.select(a).attr("cx",dscale(get_hour(a.__data__.x))+shake_dx);if(shaking){shake_me(a)}else{shake_item=undefined}}function shake_me(b){if(shake_item!=undefined&&shake_item!=b){var a=dscale(get_hour(shake_item.__data__.x));d3.select(shake_item).attr("cx",a)}shake_item=b;shaking=true;setTimeout(function(){shake_me_more()},40)}function shake_me_no(){shaking=false}function old_data_ready(){for(var b in pump_data){add_basal_endpoints(pump_data[b].basal)}var c=maxDate;var a=add_days(c,-7*4);if(a.getTime()<minDate.getTime()){a=minDate}draw_strips(a,c);sInput=d3.select("#startDateInput");sInput.attr("value",friendly_date3(a));eInput=d3.select("#endDateInput");eInput.attr("value",friendly_date3(c));msg=d3.select("#rangeMessage");msg.text("Available data is from "+friendly_date3(minDate)+" to "+friendly_date3(maxDate)+"...")}function setDates(){sInput=d3.select("#startDateInput");eInput=d3.select("#endDateInput");sdate=new Date(sInput[0][0].value);edate=new Date(eInput[0][0].value+" 00:01");if(sdate=="Invalid Date"||edate=="Invalid Date"){alert("Invalid Date")}else{if(sdate.getTime()<minDate.getTime()){sdate=minDate;sInput[0][0].value=friendly_date3(sdate);alert("earliest available data starts on "+friendly_date3(sdate))}else{if(edate.getTime()>maxDate.getTime()){edate=maxDate;eInput[0][0].value=friendly_date3(edate);alert("latest available data ends on "+friendly_date3(edate))}}draw_strips(sdate,edate)}}function old_drawing_code(){var a=8;d3.selectAll(".day-strip").selectAll("carbs").data(function(b){return pump_data[b].carbs}).enter().append("rect").attr("class","carbs").attr("x",function(b){return dscale(get_hour(b.x))-a/2}).attr("y",0).attr("width",a).attr("height",function(b){return b.y/100*strip_h}).attr("fill","lightpink").attr("opacity","0.6").style("visibility","hidden").on("mouseover",function(c,b){rect=d3.select(this);tooltip_enable(rect,format_time_carb_data(this.__data__))}).on("mouseup",function(c,b){tooltip_unlock()}).on("mouseout",function(c,b){tooltip_disable()});d3.selectAll(".day-strip").selectAll("bolus").data(function(b){return pump_data[b].bolus}).enter().append("rect").attr("class","bolus").attr("x",function(b){return dscale(get_hour(b.x))-a/2}).attr("y",function(b){return strip_h-(b.y/10*strip_h)}).attr("width",a).attr("height",function(b){return b.y/10*strip_h}).attr("fill","lightblue").attr("opacity","0.8").style("visibility","hidden").on("mouseover",function(e,b){var c=d3.select(this);tooltip_enable(c,format_time_insulin_data(this.__data__))}).on("mouseup",function(c,b){tooltip_unlock()}).on("mouseout",function(c,b){tooltip_disable()})};